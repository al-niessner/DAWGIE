function db_compare(e,t){return e.id<t.id?-1:e.id>t.id?1:0}function db_compare_num(e,t){return Number(e)<Number(t)?-1:Number(e)>Number(t)?1:0}function db_item_ref(e){return'<a href="/app/db/item?path='+e.path+'">'+e.id+"</a>"}function db_load(){db_targets(),db_versions(),db_prime()}function db_lockview(){function e(e){var t=document.getElementById("lockview"),r="";for(e.msg&&(r+=e.msg),k=0;k<e.tasks.length;k++)r+="<li>"+e.tasks[k]+"</li>";t.innerHTML=r}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_db_lockview?(t.open("GET","/app/db/lockview"),t.send()):e(JSON.parse(local_app_db_lockview))}function db_prime(){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(db_prime_table=JSON.parse(e.responseText),db_prime_org())},"undefined"==typeof local_app_db_prime?(e.open("GET","/app/db/prime"),e.send()):(db_prime_table=JSON.parse(local_app_db_prime),db_prime_org())}function db_prime_0(e){var t,n=[],d="<tbody><tr><th>State Vector</th><th>Target Name</th><th>Run ID</th></tr>";for(i=0;i<db_prime_table.length;i++)svn=db_prime_table[i].split("."),n.push(svn.slice(2,svn.length).join("."));for(n=db_unique(n),n.sort(),i=0;i<n.length;i++){var s=[];for(p=0;p<db_prime_table.length;p++)if(t=db_prime_table[p].split("."),t.slice(2,t.length).join(".")===n[i]){var o=-1,a=Number(t[0]),l=t[1];for(c=0;c<s.length;c++)s[c].id===l&&(o=c);0>o&&(s.push({id:l,rids:[]}),o=s.length-1),s[o].rids.push({id:a,path:db_prime_table[p]})}for(s.sort(db_compare),c=0;c<s.length;c++){var _="";for(s[c].rids.sort(db_compare),r=0;r<s[c].rids.length-1;r++)_+=db_item_ref(s[c].rids[r])+", ";_+=db_item_ref(s[c].rids[s[c].rids.length-1]),d+=0===c?'<tr><td rowspan="'+s.length+'">'+n[i]+"</td><td>"+s[c].id+"</td><td>"+_+"</td></tr>":"<tr><td>"+s[c].id+"</td><td>"+_+"</td></tr>"}}d+="</tbody>",e.innerHTML=d}function db_prime_1(e){var t,n=[],d="<tbody><tr><th>Run ID</th><th>Target Name</th><th>State Vector</th></tr>";for(i=0;i<db_prime_table.length;i++)n.push(db_prime_table[i].split(".")[0]);for(n=db_unique(n),n.sort(db_compare_num),r=0;r<n.length;r++){var o=[],a=0;for(p=0;p<db_prime_table.length;p++)if(t=db_prime_table[p].split("."),t[0]===n[r]){var l=-1,_=(n[r],t.slice(2,t.length).join(".")),b=t[1];for(c=0;c<o.length;c++)o[c].id===b&&(l=c);0>l&&(o.push({id:b,svns:[]}),l=o.length-1),o[l].svns.push({id:_,path:db_prime_table[p]})}for(o.sort(db_compare),c=0;c<o.length;c++)a+=o[c].svns.length;for(c=0;c<o.length;c++)for(o[c].svns.sort(db_compare),s=0;s<o[c].svns.length;s++)d+=0===c&&0===s?'<tr><td rowspan="'+a+'">'+n[r]+'</td><td rowspan="'+o[c].svns.length+'">'+o[c].id+"</td><td>"+db_item_ref(o[c].svns[s])+"</td></tr>":0===s?'<tr><td rowspan="'+o[c].svns.length+'">'+o[c].id+"</td><td>"+db_item_ref(o[c].svns[s])+"</td></tr>":"<tr><td>"+db_item_ref(o[c].svns[s])+"</td></tr>"}d+="</tbody>",e.innerHTML=d}function db_prime_2(e){var n,d=[],s="<tbody><tr><th>Target Name</th><th>State Vector</th><th>Run ID</th></tr>";for(i=0;i<db_prime_table.length;i++)d.push(db_prime_table[i].split(".")[1]);for(d=db_unique(d),d.sort(),t=0;t<d.length;t++){var o=[];for(p=0;p<db_prime_table.length;p++)if(n=db_prime_table[p].split("."),n[1]===d[t]){var a=-1,l=Number(n[0]),_=n.slice(2,n.length).join(".");d[t];for(c=0;c<o.length;c++)o[c].id===_&&(a=c);0>a&&(o.push({id:_,rids:[]}),a=o.length-1),o[a].rids.push({id:l,path:db_prime_table[p]})}for(o.sort(db_compare),c=0;c<o.length;c++){var b="";for(o[c].rids.sort(db_compare),r=0;r<o[c].rids.length-1;r++)b+=db_item_ref(o[c].rids[r])+", ";b+=db_item_ref(o[c].rids[o[c].rids.length-1]),s+=0===c?'<tr><td rowspan="'+o.length+'">'+d[t]+"</td><td>"+o[c].id+"</td><td>"+b+"</td></tr>":"<tr><td>"+o[c].id+"</td><td>"+b+"</td></tr>"}}s+="</tbody>",e.innerHTML=s}function db_prime_org(){var e=document.getElementById("org"),t=document.getElementById("prime");switch(Number(e.value)){case 0:db_prime_0(t);break;case 1:db_prime_1(t);break;case 2:db_prime_2(t);break;default:console.log("Should not be here and it means there are new options that I am not programmed to handle!!"),t.innerHTML="<p>Should not be here and it means there are new options that I am not programmed to handle!!</p>"}}function db_targets(){function e(e){var t=document.getElementById("targets");if(0===e.length)t.innerHTML="<p>No known targets</p>";else for(e.sort(),i=0;i<e.length;i++)t.innerHTML+="<li class=list-group-item>"+e[i]+"</li>"}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_db_targets?(t.open("GET","/app/db/targets"),t.send()):e(JSON.parse(local_app_db_targets))}function db_unique(e){var t=[],r={};for(i=0;i<e.length;i++)r.hasOwnProperty(e[i])||(t.push(e[i]),r[e[i]]=!0);return t}function db_ver(e){var t="";if(0<e.length){for(i=0;i<e.length-1;i++)t+=e[i]+", ";t+=e[e.length-1]}return t}function db_versions(){function e(e){var t=document.getElementById("algs"),r=document.getElementById("statevectors"),n=document.getElementById("tasks"),i=document.getElementById("values");if(0===e.length)t.innerHTML="<p>No known versions</p>",r.innerHTML="<p>No known versions</p>",n.innerHTML="<p>No known tasks</p>",i.innerHTML="<p>No known versions</p>";else{var d=Object.keys(e[0]);for(d.sort(),k=0;k<d.length;k++)n.innerHTML+="<li class=list-group-item>"+d[k]+"</li>";for(d=Object.keys(e[1]),d.sort(),k=0;k<d.length;k++)t.innerHTML+="<li class=list-group-item>"+d[k]+" : ["+db_ver(e[1][d[k]])+"]</li>";for(d=Object.keys(e[2]),d.sort(),k=0;k<d.length;k++)r.innerHTML+="<li class=list-group-item>"+d[k]+" : ["+db_ver(e[2][d[k]])+"]</li>";for(d=Object.keys(e[3]),d.sort(),k=0;k<d.length;k++)i.innerHTML+="<li class=list-group-item>"+d[k]+" : ["+db_ver(e[3][d[k]])+"]</li>"}}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_db_versions?(t.open("GET","/app/db/versions"),t.send()):e(JSON.parse(local_app_db_versions))}var db_prime_table;