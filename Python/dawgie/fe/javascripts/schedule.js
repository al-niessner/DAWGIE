// COPYRIGHT:
function schedule_crew(){function e(e){var t=document.getElementById("crew"),n="";for(n+="<h4 class='active-workers strong'>Active workers</h4>",n+="<ul class='list-group' style='list-style-type:none'>",k=0;k<e.busy.length;k++)n+='<li class="list-group-item">'+e.busy[k]+"</li>";n+='</ul><h5 class="strong">Idle count: '+e.idle+"</h5>",t.innerHTML=n}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_schedule_crew?(t.open("GET","/app/schedule/crew"),t.send()):e(JSON.parse(local_app_schedule_crew))}function schedule_doing(){function e(e){var t=document.getElementById("doing"),n=Object.keys(e);if(0===n.length)t.innerHTML="<p>No running tasks</p>";else{var r="<ul class='list-group'>";for(n.sort(),k=0;k<n.length;k++){var s=e[n[k]];for(s.sort(),r+="<li class='list-group-item'>"+n[k]+" : [",i=0;i<s.length-1;i++)r+=s[i]+", ";r+=s[s.length-1]+"]</li>"}r+="</ul>",t.innerHTML=r}}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_schedule_doing?(t.open("GET","/app/schedule/doing"),t.send()):e(JSON.parse(local_app_schedule_doing))}function schedule_failure(){function e(e){var t=document.getElementById("failure");0===e.length?t.innerHTML="<p>No failed tasks</p>":t.innerHTML=schedule_table(e)}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_schedule_failure?(t.open("GET","/app/schedule/failure"),t.send()):e(JSON.parse(local_app_schedule_failure))}function schedule_load(){schedule_crew(),schedule_doing(),schedule_failure(),schedule_success(),schedule_todo()}function schedule_success(){function e(e){var t=document.getElementById("success");0===e.length?t.innerHTML="<p>No successful tasks</p>":t.innerHTML=schedule_table(e)}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_schedule_success?(t.open("GET","/app/schedule/success"),t.send()):e(JSON.parse(local_app_schedule_success))}function schedule_table(e){var t=["runid","target","task"],n="<div class='table-responsive schedule_table'><table border='0' class='table table-bordered table-condensed'><tbody>",r=[];for(n+="<tr><th>Run ID</th><th>Target</th><th>Task Name</th><th>Timing Information</th></tr>",i=0;i<e.length;i++)e[i].time_index=new Date(e[i].timing.completed.replace(" ","T"));for(e.sort(function(e,t){var n=0;return e.time_index>t.time_index?n=-1:e.time_index<t.time_index?n=1:e.task>t.task?n=1:e.task<t.task?n=-1:e.target>t.target?n=1:e.target<t.target&&(n=-1),n}),i=0;i<e.length;i++){for(n+="<tr>",k=0;k<t.length;k++)n+='<td align="center" ; valign="top">'+e[i][t[k]]+"</td>";for(r=Object.keys(e[i].timing),r.sort(function(t,n){return e[i].timing[t]<e[i].timing[n]?-1:e[i].timing[t]>e[i].timing[n]?1:0}),n+='<td><table class="timing_table"><tbody>',tk=0;tk<r.length;tk++)n+="<tr><th>"+r[tk]+"</td><td>"+e[i].timing[r[tk]]+"</td></tr>";var s=moment(e[i].timing.started),a=moment(e[i].timing.completed);n+="<tr><th>duration</td><td>"+moment.duration(a.diff(s)).humanize()+"</td></tr>",n+="</tbody></table></td></tr>"}return n+="</tbody></table>"}function schedule_todo(){function e(e){var t=document.getElementById("todo");if(0===e.length)t.innerHTML="<p>No running tasks</p>";else{var n="<ol class='list-group'>";for(i=0;i<e.length;i++){var r=e[i].targets;for(r.sort(),n+="<li class='list-group-item'>"+e[i].name+" : [",j=0;j<r.length-1;j++)n+=r[j]+", ";n+=r[r.length-1]+"]</li>"}n+="</ol>",t.innerHTML=n}}var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(JSON.parse(t.responseText))},"undefined"==typeof local_app_schedule_todo?(t.open("GET","/app/schedule/todo"),t.send()):e(JSON.parse(local_app_schedule_todo))}